<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n">

<div metal:use-macro="load: ../layout.pt">
    <div id="content" metal:fill-slot="content">
        <h1>Create Project and Layout</h1>
    
        <p>
            This page allows projects and its experiment layouts to be loaded from a
            completed layout Excel work book. 
        </p>
        
        <p tal:condition="not clash">
            If the project already exists it will be replaced by the uploaded file.
        </p>

        <form action="${request.route_url('load_layout')}" method="post" accept-charset="utf-8" enctype="multipart/form-data">
            <div tal:condition="clash">
                <p>
                    The project that you are loading, ${clash.key}, already exists.
                </p>
                
                <p>
                    Set this check box to remove the existing project and
                    create it again.
                    
                    <input name="blat" type="checkbox" value="true"></input>
                </p>
            </div> 
            
            <p>
                <label for="upload">Project file:</label>
                <input id="upload" name="layoutfile" type="file" value=""></input>
            </p>
            
            <p>
                <input type="submit" name="submit" value="Load Project"></input>
            </p>
        </form>

        <hr/>
        
        <p>            
            <a href="${request.route_url('projects')}">Back to projects list</a>
        </p>
    </div>
</div>
</html>
