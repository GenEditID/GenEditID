<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n">


<div metal:use-macro="load: ../layout.pt">
  <div metal:fill-slot="content">
    <div class="content">
      <div class="container-fluid">
        <h1>Genome Editing Core</h1>
        <h2>Edit Project: ${project.geid}</h2>
        <hr />
        <p>
            <a href="${request.route_url('home')}">Back to projects list</a> |
            <a href="${request.route_url('project_view', projectid=project.id)}">Back to view project ${project.geid}</a>
        </p>
        <hr />

        <!-- Comments section ************************************************ -->
        <h3>Project's comments</h3>
        <form id="edit_project_form" method="post" action="${request.route_url('project_edit', projectid=project.id)}">
          <p>
            Add/update comments:
            <input id="comments_text_field" type="text" name="comments" size="100" value="${project.comments}"></input>
            <input type="submit" name="submit_comments" value="Update"></input>
          </p>
        </form>
        <hr/>

        <!-- Upload section ************************************************** -->
        <h3>Experimental data</h3>
        <h4>Plates</h4>
        <table id="platetable" class="table table-hover table-condensed">
            <thead>
                <th tal:repeat="header plate_headers">${header}</th>
            </thead>
            <tr tal:repeat="row plate_rows">
                <td tal:repeat="cell row">${cell}</td>
            </tr>
        </table>

        <h4>Upload</h4>
        <p>
            Load a new cell growth (incucyte) or protein abundance (InCell Western)
            data file for project ${project.geid}. Make sure to select the correct plate!
        </p>
        <form id="upload_project_form" method="post" action="${request.route_url('project_edit', projectid=project.id)}" accept-charset="utf-8" enctype="multipart/form-data" class="form-inline">
          <div tal:condition="clash">
              <p>
                  <span class='warning'>Warning!</span> The data that you are uploading, ${clash.key}, already exists.
              </p>
              <p>
                  Set this check box to remove the existing data associated
                  to ${clash.key}, select plate, data type and file again and upload.
                  <input name="blat" type="checkbox" value="true"></input>
              </p>
          </div>
          <div class='error' tal:condition="error">
              <p>
                  Error: ${error}
              </p>
          </div>
          <div class="form-group">
            Select the plate
            <select id="plate_selector" name="plate_selector">
              <div tal:repeat="plate platelayouts">
                <option value="plate0" tal:attributes="value plate">${plate}</option>
              </div>
            </select>
          </div>
          <div class="form-group">
            the type of data
            <select id="plate_type" name="plate_type">
              <div tal:repeat="plate platetypes">
                <option value="plate0" tal:attributes="value plate">${plate}</option>
              </div>
            </select>
          </div>
          <div class="form-group">
            and the file to upload
            <label class="btn btn-default btn-file">
              <input type="file" id="upload" name="datafile" value=""></input>
            </label>
          </div>
          <input class="btn btn-default" type="submit" name="submit" value="Upload"></input>
          <p>
              Loading data can take a few seconds. Thanks for your patience.
          </p>
        </form>
        <hr />
        <p>
            <a href="${request.route_url('home')}">Back to projects list</a> |
            <a href="${request.route_url('project_view', projectid=project.id)}">Back to view project ${project.geid}</a>
        </p>
        <hr />

      </div>
    </div>
  </div>
</div>
<script>
  $(document).ready(
    function() {
        $('#platetable').DataTable({
        } );
    } );
</script>
